function [ R,w] = fun_DWCM( X,RKA,x0 )
%FUN_DWCM 此处显示有关此函数的摘要
%   此处显示详细说明
%%先随便取个名字，距离度量的权值，协方差估计
%%X:训练数据
%%RKA:先验协方差
%%x0:检测单元
[M,N] = size(X);
distance = zeros(N,1);  %%距离度量
Sx0 = x0*x0';
for i = 1:N
    distance(i) = sum(sum(abs(X(:,i)*X(:,i)'-Sx0)));
end
% distance(N+1) = sum(sum(abs(RKA - Sx0)));
w = distance./sum(distance);
R_t = 0;
for i =1:N
    R_t = R_t + w(i)*(X(:,i)*X(:,i)');
end
% R_t = R_t + w(N+1)*RKA;
R = R_t;
end

